---
title: "Comparison of Covariance Matrix Estimation under Heavy Tails"
author: |
  | Daniel P. Palomar and Rui ZHOU
  | The Hong Kong University of Science and Technology (HKUST)
date: "`r Sys.Date()`"
output:
  prettydoc::html_pretty:
    theme: tactile
    highlight: vignette
    toc: yes
    toc_depth: 2
  html_document:
    theme: flatly
    highlight: pygments  
    toc: yes
    toc_depth: 2
csl: ieee.csl
bibliography: refs.bib
vignette: >
  %\VignetteIndexEntry{Comparison of Covariance Matrix Estimation under Heavy Tails}
  %\VignetteKeyword{covariance matrix, heavy tails, non Gaussian}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
---

```{r, echo = FALSE}
library(knitr)
opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.align = "center",
  fig.retina = 2,
  out.width = "85%",
  dpi = 96,
  pngquant = "--speed=1"
)
knitr_in_progress <- isTRUE(getOption('knitr.in.progress'))
knit_hooks$set(pngquant = hook_pngquant)
# rmarkdown::render("vignettes/CovarianceEstimationHeavyTails.Rmd", "prettydoc::html_pretty")
```

-----------
> This vignette illustrates the usage of the package [`portfolioBacktest`](https://CRAN.R-project.org/package=fitHeavyTail) 
to estimate the mean vector and covariance matrix of heavy-tailed multivariate distributions such as the angular Gaussian, Cauchy, or Student's $t$ distribution. The results are compared against existing benchmark functions from different packages.


# Installation
The package can be installed from [CRAN](https://CRAN.R-project.org/package=fitHeavyTail) or [GitHub](https://github.com/dppalomar/fitHeavyTail):
```{r, eval=FALSE}
# install stable version from CRAN
install.packages("fitHeavyTail")

# install development version from GitHub
devtools::install_github("dppalomar/fitHeavyTail")

# Getting help
library(fitHeavyTail)
help(package = "fitHeavyTail")
?fit_mvt
```



# Quick Start
To illustrate the simple usage of the package `fitHeavyTail`, let's start by generating some multivariate data under a Student's $t$ distribution with significant heavy tails ($\nu=4$):
```{r}
library(mvtnorm)  # package for multivariate t distribution
N <- 10   # number of variables
T <- 80   # number of observations
nu <- 4   # degrees of freedom for tail heavyness

set.seed(42)
mu <- rep(0, N)
U <- t(rmvnorm(n = round(0.3*N), sigma = 0.1*diag(N)))
Sigma <- U %*% t(U) + diag(N)  # covariance matrix with factor model structure
Sigma_scatter <- (nu-2)/nu * Sigma
X <- rmvt(n = T, delta = mu, sigma = Sigma_scatter, df = nu)  # generate data
```

We can first estimate the mean vector and covariance matrix via the traditional sample estimates (i.e., sample mean and sample covariance matrix):
```{r}
mu_sm <- colMeans(X)
Sigma_scm <- cov(X)
```

Then we can compute the robust estimates via the package `fitHeavyTail`:
```{r}
library(fitHeavyTail)
fitted <- fit_mvt(X)
```

We can now compute the estimation errors and see the big improvement:
```{r}
sum((mu_sm - mu)^2)
sum((fitted$mu - mu)^2)

sum((Sigma_scm - Sigma)^2)
sum((fitted$cov - Sigma)^2)
```

To get a visual idea of the robustness, we can plot the shapes of the covariance matrices (true and estimated ones) projected on two dimensions. Observe how the heavy-tailed estimation follows the true one more closely than the sample covariance matrix:
```{r, eval=FALSE, echo=FALSE}
library(ellipse)

i1 <- 7  #7-4, 7-5
i2 <- 5
# for (i1 in 1:N)
#   for (i2 in 1:N) {
# print(i1); print(i2)
plot(X[, i1], X[, i2], 
     main = "Scatter plot of Gaussian returns", xlab = "asset 1", ylab = "asset 2",
     col = rgb(0, 100, 0, 100, maxColorValue = 255), pch = 16)
lines(ellipse(Sigma[c(i1, i2), c(i1, i2)]), col = "black", lwd = 2)
lines(ellipse(Sigma_scm[c(i1, i2), c(i1, i2)], centre = mu_sm[c(i1, i2)]), col = "red", lwd = 2)
lines(ellipse(fitted$cov[c(i1, i2), c(i1, i2)], centre = fitted$mu[c(i1, i2)]), col = "blue", lwd = 2)
# readline()
# }
```


```{r, echo=FALSE, fig.width = 9, fig.height = 5, out.width = "100%"}
library(ggplot2)
library(ellipse)

i1 <- 7; i2 <- 5
ggplot(data.frame(x = X[, i1], y = X[, i2]), aes(x, y)) +
  geom_point(alpha = 0.7, size = 3) +
  geom_path(data = data.frame(ellipse(Sigma[c(i1, i2), c(i1, i2)])), 
            aes(x, y, col = "true"), lwd = 1) +
  geom_path(data = data.frame(ellipse(Sigma_scm[c(i1, i2), c(i1, i2)], centre = mu_sm[c(i1, i2)])), 
            aes(x, y, col = "SCM estimation"), lwd = 1) +
  geom_path(data = data.frame(ellipse(fitted$cov[c(i1, i2), c(i1, i2)], centre = fitted$mu[c(i1, i2)])), 
            aes(x, y, col = "heavy-tailed estimation"), lwd = 1) +
  scale_colour_manual(name = "ellipses",
                      values = c("true" = "black", "SCM estimation" = "red", "heavy-tailed estimation" = "blue")) +
  guides(color = guide_legend(reverse = TRUE)) +
  labs(title = "Data points and shapes of covariance matrices", x = NULL, y = NULL)
```






# Numerical Comparison with Existing Packages
In the following, we generate multivariate heavy-tailed Student's $t$ distributed data and compare the performance of many different existing packages in terms of estimation accurary measured by the mean squared error (MSE) and cpu time.

```{r, echo=FALSE}
library(mvtnorm)
library(fitHeavyTail)
library(ggplot2)
library(reshape2)

N <- 20
nu <- 4
mu <- rep(0, N)

set.seed(357)
U <- t(rmvnorm(n = round(0.3*N), sigma = 0.1*diag(N)))
Sigma <- U %*% t(U) + diag(N)
Sigma_scatter <- (nu-2)/nu * Sigma
# qplot(eigen(Sigma)$values, geom = "histogram", xlab = "eigenvalues", fill = I("cyan"), col = I("black"),
#       main = "Histogram of eigenvalues of true covariance matrix")
```

```{r, echo=FALSE, cache=TRUE}
N_realiz <- 100  # multiple realizations for averaging
T_sweep <- round(seq(from = ceiling(1.5*N), to = 5*N, length.out = 12))
MSE_rrcov_CovMrcd_T <- MSE_covRobust_cov.nnve_T <- MSE_robust_covRob_T <- MSE_robustbase_covMcd_T <- 
  MSE_MASS_cov.mve_T <- MSE_MASS_cov.trov_T <- MSE_QRM_fit.mst_T <- 
  MSE_fitHeavyTail_Studentt_T <- MSE_fitHeavyTail_Studentt_nu_T <- MSE_fitHeavyTail_Cauchy_T <- MSE_fitHeavyTail_Tyler_T <- MSE_SCM_T <- NULL
time_rrcov_CovMrcd_T <- time_covRobust_cov.nnve_T <- time_robust_covRob_T <- time_robustbase_covMcd_T <- 
  time_MASS_cov.mve_T <- time_MASS_cov.trov_T <- time_QRM_fit.mst_T <- 
  time_fitHeavyTail_Studentt_T <- time_fitHeavyTail_Studentt_nu_T <- time_fitHeavyTail_Cauchy_T <- time_fitHeavyTail_Tyler_T <- time_SCM_T <- NULL
if (!knitr_in_progress) pbar <- txtProgressBar(min = it<-0, max = length(T_sweep), style=3)
for(T in T_sweep) {
  if (!knitr_in_progress) setTxtProgressBar(pbar, it<-it+1)
  MSE_rrcov_CovMrcd <- MSE_covRobust_cov.nnve <- MSE_robust_covRob <- MSE_robustbase_covMcd <- 
    MSE_MASS_cov.mve <- MSE_MASS_cov.trov <- MSE_QRM_fit.mst <- 
    MSE_fitHeavyTail_Studentt <- MSE_fitHeavyTail_Studentt_nu <- MSE_fitHeavyTail_Cauchy <- MSE_fitHeavyTail_Tyler <- MSE_SCM <- 0
  time_rrcov_CovMrcd <- time_covRobust_cov.nnve <- time_robust_covRob <- time_robustbase_covMcd <- 
    time_MASS_cov.mve <- time_MASS_cov.trov <- time_QRM_fit.mst <- 
    time_fitHeavyTail_Studentt <- time_fitHeavyTail_Studentt_nu <- time_fitHeavyTail_Cauchy <- time_fitHeavyTail_Tyler <- time_SCM <- 0
  for (ii in 1:N_realiz) {
    # generate data
    X <- rmvt(n = T, delta = mu, sigma = Sigma_scatter, df = nu)  # heavy-tailed data
    #X <- rmvnorm(n = T, mean = mu, sigma = Sigma)  # Gaussian data


    # Sigma estimation
    time_SCM <- time_SCM + system.time({
      Sigma_SCM <- cov(X)
    })["elapsed"]

    time_fitHeavyTail_Tyler <- time_fitHeavyTail_Tyler + system.time({
      Sigma_fitHeavyTail_Tyler <- fitHeavyTail:::momentsTyler(X)$cov
    })["elapsed"]

    time_fitHeavyTail_Cauchy <- time_fitHeavyTail_Cauchy + system.time({
      Sigma_fitHeavyTail_Cauchy <- fitHeavyTail:::momentsCauchy(X)$cov
    })["elapsed"]

    time_fitHeavyTail_Studentt_nu <- time_fitHeavyTail_Studentt_nu + system.time({
      Sigma_fitHeavyTail_Studentt_nu <- fit_mvt(X, nu = 6)$cov
      # res <- fit_mvt(X, nu = 6, ftol = 1e6, return_iterates = TRUE)
      # plot(sapply(res$iterations_record, `[[`, "nu"))
      # plot(sapply(res$iterations_record, `[[`, "log_likelihood"))
    })["elapsed"]

    time_fitHeavyTail_Studentt <- time_fitHeavyTail_Studentt + system.time({
      Sigma_fitHeavyTail_Studentt <- fit_mvt(X, nu_regcoef = 1e0, verbose = FALSE)$cov
      # res <- fit_mvt(X, ftol = 1e6, return_iterates = TRUE)
      # plot(sapply(res$iterations_record, `[[`, "nu"))
      # plot(sapply(res$iterations_record, `[[`, "log_likelihood"))
    })["elapsed"]

    time_QRM_fit.mst <- time_QRM_fit.mst + system.time({
      Sigma_QRM_fit.mst <- tryCatch(
        as.matrix(QRM::fit.mst(X, method = "BFGS", nit = 100, tol = 1e-6)$covariance),
        warning = function(w) return(NA),
        error   = function(e) return(NA))
    })["elapsed"]

    time_MASS_cov.trov <- time_MASS_cov.trov + system.time({
      Sigma_MASS_cov.trov <- MASS::cov.trob(X, nu = 6)$cov
    })["elapsed"]
    
    time_MASS_cov.mve <- time_MASS_cov.mve + system.time({
      Sigma_MASS_cov.mve <- MASS::cov.mve(X)$cov
    })["elapsed"]

    time_robustbase_covMcd <- time_robustbase_covMcd + system.time({
      Sigma_robustbase_covMcd <- suppressWarnings(robustbase::covMcd(X)$cov)
    })["elapsed"]
    
    time_robust_covRob <- time_robust_covRob + system.time({
      Sigma_robust_covRob <- tryCatch(
        robust::covRob(X, estim = "pairwiseQC")$cov,  # "pairwiseQC", also: "weighted", "M", "pairwiseGK"
        warning = function(w) return(NA),
        error   = function(e) return(NA))
    })["elapsed"]
    
    time_covRobust_cov.nnve <- time_covRobust_cov.nnve + system.time({
      Sigma_covRobust_cov.nnve <- covRobust::cov.nnve(X)$cov
    })["elapsed"]

    time_rrcov_CovMrcd <- time_rrcov_CovMrcd + system.time({
      Sigma_rrcov_CovMrcd <- rrcov::CovMrcd(X)$cov
    })["elapsed"]
        
    

    # compute MSEs
    MSE_SCM                      <- MSE_SCM                      + norm(Sigma_SCM - Sigma, "F")^2
    MSE_fitHeavyTail_Tyler       <- MSE_fitHeavyTail_Tyler       + norm(Sigma_Tyler - Sigma, "F")^2
    MSE_fitHeavyTail_Cauchy      <- MSE_fitHeavyTail_Cauchy      + norm(Sigma_fitHeavyTail_Cauchy - Sigma, "F")^2
    MSE_fitHeavyTail_Studentt_nu <- MSE_fitHeavyTail_Studentt_nu + norm(Sigma_fitHeavyTail_Studentt_nu - Sigma, "F")^2
    MSE_fitHeavyTail_Studentt    <- MSE_fitHeavyTail_Studentt    + norm(Sigma_fitHeavyTail_Studentt - Sigma, "F")^2
    MSE_QRM_fit.mst              <- MSE_QRM_fit.mst              + norm(Sigma_QRM_fit.mst - Sigma, "F")^2
    MSE_MASS_cov.trov            <- MSE_MASS_cov.trov            + norm(Sigma_MASS_cov.trov - Sigma, "F")^2
    MSE_MASS_cov.mve             <- MSE_MASS_cov.mve             + norm(Sigma_MASS_cov.mve - Sigma, "F")^2
    MSE_robustbase_covMcd        <- MSE_robustbase_covMcd        + norm(Sigma_robustbase_covMcd - Sigma, "F")^2
    MSE_robust_covRob            <- MSE_robust_covRob            + norm(Sigma_robust_covRob - Sigma, "F")^2
    MSE_covRobust_cov.nnve       <- MSE_covRobust_cov.nnve       + norm(Sigma_covRobust_cov.nnve  - Sigma, "F")^2
    MSE_rrcov_CovMrcd            <- MSE_rrcov_CovMrcd            + norm(Sigma_rrcov_CovMrcd  - Sigma, "F")^2
  }
  # keep track of MSEs
  MSE_SCM_T                      <- c(MSE_SCM_T,                      MSE_SCM / N_realiz)
  MSE_fitHeavyTail_Tyler_T       <- c(MSE_fitHeavyTail_Tyler_T,       MSE_fitHeavyTail_Tyler / N_realiz)
  MSE_fitHeavyTail_Cauchy_T      <- c(MSE_fitHeavyTail_Cauchy_T,      MSE_fitHeavyTail_Cauchy / N_realiz)
  MSE_fitHeavyTail_Studentt_nu_T <- c(MSE_fitHeavyTail_Studentt_nu_T, MSE_fitHeavyTail_Studentt_nu / N_realiz)
  MSE_fitHeavyTail_Studentt_T    <- c(MSE_fitHeavyTail_Studentt_T,    MSE_fitHeavyTail_Studentt / N_realiz)
  MSE_QRM_fit.mst_T              <- c(MSE_QRM_fit.mst_T,              MSE_QRM_fit.mst / N_realiz)
  MSE_MASS_cov.trov_T            <- c(MSE_MASS_cov.trov_T,            MSE_MASS_cov.trov / N_realiz)
  MSE_MASS_cov.mve_T             <- c(MSE_MASS_cov.mve_T,             MSE_MASS_cov.mve / N_realiz)
  MSE_robustbase_covMcd_T        <- c(MSE_robustbase_covMcd_T,        MSE_robustbase_covMcd / N_realiz)
  MSE_robust_covRob_T            <- c(MSE_robust_covRob_T,            MSE_robust_covRob / N_realiz)
  MSE_covRobust_cov.nnve_T       <- c(MSE_covRobust_cov.nnve_T,       MSE_covRobust_cov.nnve / N_realiz)
  MSE_rrcov_CovMrcd_T            <- c(MSE_rrcov_CovMrcd_T,            MSE_rrcov_CovMrcd / N_realiz)
  
  # keep track of times
  time_SCM_T                      <- c(time_SCM_T,                      time_SCM / N_realiz)
  time_fitHeavyTail_Tyler_T       <- c(time_fitHeavyTail_Tyler_T,       time_fitHeavyTail_Tyler / N_realiz)
  time_fitHeavyTail_Cauchy_T      <- c(time_fitHeavyTail_Cauchy_T,      time_fitHeavyTail_Cauchy/ N_realiz)
  time_fitHeavyTail_Studentt_nu_T <- c(time_fitHeavyTail_Studentt_nu_T, time_fitHeavyTail_Studentt_nu / N_realiz)
  time_fitHeavyTail_Studentt_T    <- c(time_fitHeavyTail_Studentt_T,    time_fitHeavyTail_Studentt / N_realiz)
  time_QRM_fit.mst_T              <- c(time_QRM_fit.mst_T,              time_QRM_fit.mst / N_realiz)
  time_MASS_cov.trov_T            <- c(time_MASS_cov.trov_T,            time_MASS_cov.trov / N_realiz)
  time_MASS_cov.mve_T             <- c(time_MASS_cov.mve_T,             time_MASS_cov.mve / N_realiz)
  time_robustbase_covMcd_T        <- c(time_robustbase_covMcd_T,        time_robustbase_covMcd / N_realiz)
  time_robust_covRob_T            <- c(time_robust_covRob_T,            time_robust_covRob / N_realiz)
  time_covRobust_cov.nnve_T       <- c(time_covRobust_cov.nnve_T,       time_covRobust_cov.nnve / N_realiz)
  time_rrcov_CovMrcd_T            <- c(time_rrcov_CovMrcd_T,            time_rrcov_CovMrcd / N_realiz)
}
```


```{r, warning=FALSE, echo=FALSE, fig.width = 9, fig.height = 5, out.width = "100%"}
# MSE plot
MSE_all_T <- cbind("stats::cov"                   = MSE_SCM_T,
                   "QRM::fit.mst"                 = MSE_QRM_fit.mst_T,
                   "MASS::cov.trob (nu=6)"        = MSE_MASS_cov.trov_T,
                   "MASS::cov.mve"                = MSE_MASS_cov.mve_T,
                   "robustbase::covMcd"           = MSE_robustbase_covMcd_T,
                   "robust::covRob"               = MSE_robust_covRob_T,
                   "covRobust::cov.nnve"          = MSE_covRobust_cov.nnve_T,
                   "fitHeavyTail::fit_Tyler"      = MSE_fitHeavyTail_Tyler_T,
                   "fitHeavyTail::fit_Cauchy"     = MSE_fitHeavyTail_Cauchy_T,
                   "fitHeavyTail::fit_mvt (nu=6)" = MSE_fitHeavyTail_Studentt_nu_T,
                   "fitHeavyTail::fit_mvt"        = MSE_fitHeavyTail_Studentt_T)
rownames(MSE_all_T) <- T_sweep
ggplot(melt(MSE_all_T, varnames = c("Var1", "method")), aes(x = Var1, y = value, col = method, shape = method)) +
  geom_line() + geom_point(size = 2) + scale_y_log10() +  # coord_cartesian(ylim = c(0, 500)) +
  scale_shape_manual(values = 1:ncol(MSE_all_T)) +  # theme(legend.title = element_blank())
  ggtitle(bquote("MSE of covariance matrix estimation for heavy-tailed data (" * N == .(N) * "," ~ nu == .(nu)* ")")) +
  xlab("T") + ylab("MSE")
# ggtitle(latex2exp::TeX(sprintf("MSE of covariance matrix estimation for heavy-tailed data (N = %d, $\\nu$ = %.2f)", N, nu))) +
# check here is TeX problem has been fixed: https://github.com/stefano-meschiari/latex2exp/pull/21


# time plot
time_all_T <- cbind("stats::cov"                   = time_SCM_T,
                    "QRM::fit.mst"                 = time_QRM_fit.mst_T,
                    "MASS::cov.trob (nu=6)"        = time_MASS_cov.trov_T,
                    "MASS::cov.mve"                = time_MASS_cov.mve_T,
                    "robustbase::covMcd"           = time_robustbase_covMcd_T,
                    "robust::covRob"               = time_robust_covRob_T,
                    "covRobust::cov.nnve"          = time_covRobust_cov.nnve_T,
                    "fitHeavyTail::fit_Tyler"      = time_fitHeavyTail_Tyler_T,
                    "fitHeavyTail::fit_Cauchy"     = time_fitHeavyTail_Cauchy_T,
                    "fitHeavyTail::fit_mvt (nu=6)" = time_fitHeavyTail_Studentt_nu_T,
                    "fitHeavyTail::fit_mvt"        = time_fitHeavyTail_Studentt_T)
rownames(time_all_T) <- T_sweep
time_all_T[is.na(MSE_all_T)] <- NA
ggplot(melt(time_all_T, varnames = c("Var1", "method")), aes(x = Var1, y = value, col = method, shape = method)) +
  geom_line() + geom_point(size = 2) + scale_y_log10() +
  scale_shape_manual(values = 1:ncol(time_all_T)) +
  ggtitle(bquote("Computational cost for different methods (" * N == .(N) * "," ~ nu == .(nu)* ")")) +
  xlab("T") + ylab("cpu time")


# joint MSE-time plot
ggplot(data.frame("MSE" = MSE_all_T["100", ], "cpu_time" = time_all_T["100", ], "method" = colnames(MSE_all_T)), 
       aes(x = cpu_time, y = MSE, col = method)) +
  scale_color_discrete(limits = colnames(MSE_all_T)) +  # this is to order the legend items
  geom_point(size = 3) +
  geom_ellipse(aes(x0 = 0.004, y0 = 11, a = 8e-3, b = 4, angle = 0), col = "black", size = 0.5) +
  ggtitle(bquote("Performance vs cpu time for different methods (" * N == .(N) * ", T = 100," ~ nu == .(nu)* ")"))
```

From the numerical results we can draw several observations:

- `stats:cov()` is the sample covariance matrix (SCM). As expected, it is not robust to heavy tails and has the worst estimation error although enjoyes the lowest computational cost. It is not acceptable for heavy-tailed distributions.
- `QRM::fit.mst()` has one of the highest computational cost with a not-so-good estimation error.
- `MASS::cov.trob()` with fixed `nu = 6` assumes the data follows a multivariate $t$ distribution; it shows a good performance in terms of MSE and cpu time. It is probably the best choice among the benchmark existing packages (with the advantage that it comes preinstalled with base R in the package `MASS`).
- `MASS::cov.mve()` shows one of the worst performance in terms of both estimation error and computational cost.
- `robustbase::covMcd()` also shows one of the worst performance in terms of both estimation error and computational cost. 
- `robust::covRob()` has a low computational cost but bad estimation error.
- `covRobust::cov.nnve()` shows a bad performance in terms of both estimatior error and cpu time.
- `fitHeavyTail::fit_Tyler()` normalizes the data (to get rid of the shape of the tail); it shows a very small estimation error with an acceptable computational cost.
- `fitHeavyTail::fit_Cauchy()` assumes a multivariate Cauchy distribution and depending on the ratio $N/T$ can be better or worse than the Tyler counterpart.
- `fitHeavyTail::fit_mvt()` assumes the data follows a multivariate $t$ distribution; it shows a small estimation error with accepteable computational cost.
- `fitHeavyTail::fit_mvt()` with fixed `nu = 6` seems to perform much better than `fitHeavyTail::fit_mvt()` which also estimates `nu`.


Concluding, the top choices seem to be (in order):

1. `fitHeavyTail::fit_mvt()` (with `nu = 6`),
2. `fitHeavyTail::fit_Tyler()` or `fitHeavyTail::fit_Tyler()` depending on the ratio $N/T$, and
3. `MASS::cov.trob()` (with the advantage of being preinstalled with base R).


The winner seems to be by a big margin `fitHeavyTail::fit_mvt()` (with `nu = 6`).



# Algorithm Description
The specific algorithms used are based either on the Expectation-Maximization (EM) algorithm or on the more general Majorization-Minimization (MM) algorithm [@SunBabPal2017]. In particular:

- The function `fitHeavyTail::fit_Tyler()` normalizes the samples, which then have an angular Gaussian distribution on the sphere, and performs a maximum likelihood estimation (MLE) based on the MM algorithm [@SunBabPal2014].

- The function `fitHeavyTail::fit_Cauchy()` assumes that the data follows a multivariate Cauchy distribution and performs an MLE based on the MM algorithm [@SunBabPal2015].

- The function `fitHeavyTail::fit_mvt()` assumes the the data follows a multivariate Student's $t$ distribution and performs an MLE based on the EM algorithm [@LiuRubin95]. This function can also incorporate a factor model structure on the covariance matrix and the algorithm is then based on the paper [@ZhouLiuKumarPalomar2019] (available in [arXiv](https://arxiv.org/abs/1909.12530)).



# References {-}
\setlength{\parindent}{-0.2in}
\setlength{\leftskip}{0.2in}
\setlength{\parskip}{8pt}
\noindent
